<div class="advancedSearchBox" (keyup.enter)="searchService.submitSearch(); searchService.removeAllSuggestedChoices()">

    <!-- selected search parameter -->
    <div class="selected-parameters" *ngFor = "let p of searchService.displayParams; index as i">
        <!-- parameters -->
        <div class="search-parameter" (click)="searchService.removeAllSuggestedChoices(i)">
            <div> {{ p.getKey() }}: </div>
            <div *ngIf="p.getSearchParam().getType() === 'SearchParameter'">
                <input [(ngModel)]="p.value" #valueInput placeholder={{p.getSearchParam().getPlaceholder()}} class="value-input"
                (keyup)="searchService.showSuggestedChoices(valueInput.value, i)" 
                (click)="searchService.showSuggestedChoices(valueInput.value, i)">

                <!-- available choices -->
                <span *ngIf="p.getDisplayChoices().length" class="pop-up">
                  <ul *ngFor="let c of p.getDisplayChoices()" >
                      <li (click)="searchService.addValueToDisplay(c, i)" > {{ c }} </li>
                  </ul>
                </span>
            </div>

            <div *ngIf="p.getSearchParam().getType() === 'SearchDatetime'">
                <input type="date" value pattern="^[0-9]{4}-(0[1-9]|1[0-2])-(0[1-9]|[1-2][0-9]|3[0-1])$"
                [(ngModel)]="p.getSearchParam().date" >

                <input type="number" size="2" min="00" max="23" placeholder="HH"
                [(ngModel)]="p.getSearchParam().hour" > :
                <!-- need choices for hours -->
                <input type="number" size="2" min="00" max="59" placeholder="MM"
                [(ngModel)]="p.getSearchParam().minute" >
            </div>

            <div *ngIf="p.getSearchParam().getType() === 'SearchHoursRange'">
                <input type="number" min="0" max="36"
                [(ngModel)]="p.getSearchParam().hoursBefore" placeholder="hrs before"> /
                <input type="number" min="0" max="36"
                [(ngModel)]="p.getSearchParam().hoursAfter" placeholder="hrs after">
            </div>

            <button (click)="searchService.removeDisplay(i)">x</button>

        </div>
    </div>

    <!-- the actual "search box" -->
    <input [(ngModel)]="searchService.searchString" #searchBox placeholder="Search..." class="search-parameter-input"
        (click)="searchService.showSuggestedParameters(searchBox.value, true); searchService.removeAllSuggestedChoices()"
        (keyup)="searchService.showSuggestedParameters(searchBox.value, false)">

</div>

<!-- suggestions as you type in the search box -->
<div class="search-parameter-suggestions" *ngFor="let suggestion of searchService.suggestedParams">
    <span class="search-parameter" (click)="searchService.addSuggestedParameter(suggestion)"> {{suggestion.getDisplayName()}}</span>
</div>

<div>
    <button *ngIf="searchService.searchBtnText" (click)="searchService.submitSearch()">{{searchService.searchBtnText}}</button>
    <div *ngFor="let m of searchService.message">
        <span> {{m}} </span>
    </div>
</div>
